# Dyna-Q-experiments

# Реализация и анализ алгоритма Dyna на детерминированной и стохастической среде

### Детерминированная среда:

• Реализация табличного алгоритма Dyna.

• Тестирование Dyna с различным количеством шагов планирования начиная с 0 (которое соответствует обычному Q-обучению).

• Сравнение результатов в виде графиков суммарного вознаграждения и времени обучения для каждого значения шагов планирования.

### Стохастическая среда:

• Модификация среды, чтобы она стала стохастической, удостоверившись, что нескольких состояний существует как минимум два состояния с ненулевой вероятностью перехода.

• Адаптация алгоритма Dyna для учета стохастичности среды.

### Реализация

В наглядном варианте эксперименты отражены в ноутбуке

### Визуализация

[https://wandb.ai/senich17/Dune-Q%20I?nw=nwusersenich17]

## Вывод основанный на результатах исследования 

### Дримминг как cтратегия

• Как и стратегия, дримминг направлен на долгосрочное планирование и обобщение знаний. Это помогает агенту развивать более глубокое понимание среды и вырабатывать оптимальные стратегии для достижения долгосрочных целей (например не набор очков за шаг, а победа в игре как таковой).После завершения нескольких эпизодов игры агент переходит в режим дримминга. Он использует все накопленные данные для симуляции множества переходов и обновления Q-значений.

• Используется обычно в периоды бездействия или после завершения эпизодов. Это позволяет агенту уделять время на "обдумывание" и анализ большого объема данных.

• В конечном итоге это позволяет агенту выявить долгосрочные паттерны и стратегии, которые помогут ему лучше справляться с игрой в целом.

### Планирование как тактика

• Подобно тактике, планирование фокусируется на краткосрочных действиях и адаптации к текущим условиям. Это помогает агенту быстро реагировать на изменения в среде и оптимизировать свои действия в ближайшей перспективе (набор очков за каждый шаг, в моменте).

• Используется регулярно, например, после каждого шага или набора шагов. Частое обновление Q-значений позволяет агенту оперативно корректировать свои действия.

• Целью является улучшение текущих решений и поведения на основе последних полученных данных.

### Итог

• Планирование (тактический подход) помогает агенту быстро и эффективно реагировать на текущие вызовы и условия, оптимизируя его действия в краткосрочной перспективе. Агент играет в игру и после каждого действия, например, делает 5 шагов планирования. Он использует модель для симуляции ближайших переходов и обновления Q-значений.

• Дримминг (стратегический подход) позволяет агенту обобщать накопленный опыт и вырабатывать оптимальные стратегии для достижения долгосрочных целей.

• Использование обоих подходов в Dyna-Q помогает создать сбалансированного агента, который может эффективно действовать как в краткосрочной, так и в долгосрочной перспективе.
